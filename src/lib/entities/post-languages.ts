import * as v from 'valibot';

export const postLanguages = [
	'aa',
	'ab',
	'ae',
	'af',
	'ak',
	'am',
	'an',
	'ar',
	'as',
	'av',
	'ay',
	'az',
	'ba',
	'be',
	'bg',
	'bh',
	'bi',
	'bm',
	'bn',
	'bo',
	'br',
	'bs',
	'ca',
	'ce',
	'ch',
	'co',
	'cr',
	'cs',
	'cu',
	'cv',
	'cy',
	'da',
	'de',
	'dv',
	'dz',
	'ee',
	'el',
	'en',
	'eo',
	'es',
	'et',
	'eu',
	'fa',
	'ff',
	'fi',
	'fj',
	'fo',
	'fr',
	'fy',
	'ga',
	'gd',
	'gl',
	'gn',
	'gu',
	'gv',
	'ha',
	'he',
	'hi',
	'ho',
	'hr',
	'ht',
	'hu',
	'hy',
	'hz',
	'ia',
	'id',
	'ie',
	'ig',
	'ii',
	'ik',
	'io',
	'is',
	'it',
	'iu',
	'ja',
	'jv',
	'ka',
	'kg',
	'ki',
	'kj',
	'kk',
	'kl',
	'km',
	'kn',
	'ko',
	'kr',
	'ks',
	'ku',
	'kv',
	'kw',
	'ky',
	'la',
	'lb',
	'lg',
	'li',
	'ln',
	'lo',
	'lt',
	'lu',
	'lv',
	'mg',
	'mh',
	'mi',
	'mk',
	'ml',
	'mn',
	'mr',
	'ms',
	'mt',
	'my',
	'na',
	'nb',
	'nd',
	'ne',
	'ng',
	'nl',
	'nn',
	'no',
	'nr',
	'nv',
	'ny',
	'oc',
	'oj',
	'om',
	'or',
	'os',
	'pa',
	'pi',
	'pl',
	'ps',
	'pt',
	'qu',
	'rm',
	'rn',
	'ro',
	'ru',
	'rw',
	'sa',
	'sc',
	'sd',
	'se',
	'sg',
	'si',
	'sk',
	'sl',
	'sm',
	'sn',
	'so',
	'sq',
	'sr',
	'ss',
	'st',
	'su',
	'sv',
	'sw',
	'ta',
	'te',
	'tg',
	'th',
	'ti',
	'tk',
	'tl',
	'tn',
	'to',
	'tr',
	'ts',
	'tt',
	'tw',
	'ty',
	'ug',
	'uk',
	'ur',
	'uz',
	've',
	'vi',
	'vo',
	'wa',
	'wo',
	'xh',
	'yi',
	'yo',
	'za',
	'zh',
	'zu'
] as const;
export const postLanguageSchema = v.picklist(postLanguages);
export type PostLanguage = v.InferOutput<typeof postLanguageSchema>;

const languageToLanguageName = new Map<PostLanguage, string>();
const languageNameToLanguages = new Map<string, Set<PostLanguage>>();

const sourceOfTruth = new Intl.DisplayNames(undefined, { type: 'language' });

for (const language of postLanguages) {
	let languageName = sourceOfTruth.of(language) || language;
	languageToLanguageName.set(language, languageName);

	const languagesThatHaveThisSameName = languageNameToLanguages.get(languageName) ?? new Set();
	languagesThatHaveThisSameName.add(language);

	if (languagesThatHaveThisSameName.size > 1) {
		for (const language of languagesThatHaveThisSameName) {
			languageToLanguageName.set(language, `${languageName} (${language})`);
		}
	}

	languageNameToLanguages.set(languageName, languagesThatHaveThisSameName);
}

export function getLanguageName(lang: PostLanguage) {
	return languageToLanguageName.get(lang) ?? lang;
}
